webpackJsonp([2],{0:function(e,t,a){e.exports=a(96)},96:function(e,t,a){(function(e){"use strict";function t(e){return e&&e.__esModule?e:{"default":e}}var o=a(97),n=t(o);a(98),e(function(){(0,n["default"])()})}).call(t,a(1))},97:function(e,t,a){(function(e,o){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var i=a(69),s=n(i),d=a(84),l=n(d),r=a(88),u=n(r),f=a(89),m=n(f);Object.defineProperty(t,"__esModule",{value:!0});var c=a(92),v=n(c),h=a(17),g=n(h),p=a(93),w=n(p),y=a(14),x=n(y),M=function(e){return e.preventDefault(),e.stopImmediatePropagation(),!1},D=function(){function t(){(0,u["default"])(this,t),this.data={},this.init(),this.status={isMoveing:!1},this.index=-1,this.page=null,this.canMouse=!1}return(0,m["default"])(t,[{key:"init",value:function(){var t=this;e("body").on("mousewheel",function(a){if(0==a.deltaY||t.status.isMoveing)return!1;var o=a.deltaY<0,n=!o,i=t.getScrollPostion(),s="up",d=!1;i.isBottom&&o&&t.data.way.onway.length-1>t.index?(t.index++,d=!0):n&&i.isTop&&(t.index>0?(t.index--,s="down",d=!0):0==t.index&&(t.index--,t.togglePage(t.page,e(".userInfo"),"down"))),t.index>-1&&d&&t.changePage(s)}),this.getData()}},{key:"changePage",value:function(t){var a=this;a.togglePage(a.page,e("#momentInfo_"+a.index),t),a.map.move(a.index,1e3),a.doms.timelines.filter(".focused").removeClass("focused").tooltipster("hide").off("mouseover mouseout",M);var o=a.doms.timelines.filter("[index='"+a.index+"']").on("mouseover mouseout",M);a.doms.timelinesDiv.width()/2-o.offset().left<0?a.doms.timelinesDiv.scrollLeft(o.offset().left-a.doms.timelinesDiv.width()/2):a.doms.timelinesDiv.width()/2-o.offset().left>0&&a.doms.timelinesDiv.scrollLeft(0),o.addClass("focused").tooltipster("show")}},{key:"togglePage",value:function(e,t,a){var o=this;o.hideMouse(),o.status.isMoveing=!0,e.addClass("transform from-start "+a),t.addClass("show transform to-start "+a),t.scrollTop(0),o.page=t,setTimeout(function(){e.addClass("from-end"),t.addClass("to-end")},0),setTimeout(function(){o.status.isMoveing=!1,e.removeClass("show transform from-start from-end "+a),t.removeClass("transform to-start to-end "+a),e.scrollTop(0),o.loadImages(),o.getScrollPostion()},1e3)}},{key:"loadImages",value:function(){var t=this;e(".images img",t.page).each(function(t,a){var o=e(a);o.data("havepic")||(a.src=o.attr("vsrc"),o.data("havepic",!0))})}},{key:"getScrollPostion",value:function(e){e=e||0;var t=this,a=!1,o=!1,n=t.page.scrollTop(),i=t.page.height(),s=t.page.children().height(),d=s-(n+i),l=110>d;return a=0==n,o=i>=s||0==d,l?t.showMouse():t.hideMouse(),{isTop:a,isBottom:o,isPageDown:l,y:n}}},{key:"showMouse",value:function(){var e=this;return e.canMouse?!1:(e.doms.mouse.addClass("show"),void(e.canMouse=!0))}},{key:"hideMouse",value:function(){var e=this;return e.canMouse?(e.doms.mouse.removeClass("show"),void(e.canMouse=!1)):!1}},{key:"dealData",value:function(){var e=this,t=e.data.way;t.start=t.onway[0],t.end=t.plan[t.plan.length-1];var a=[],o=[],n=void 0,i={},d=function(){if(o.length>0){var e={date:o[0].date,data:o};e.showDate=(0,x["default"])(e.date).format(),a.push(e),o=[]}},r=!0,u=!1,f=void 0;try{for(var m,c=(0,l["default"])(t.onway.entries());!(r=(m=c.next()).done);r=!0){var v=(0,s["default"])(m.value,2),h=v[0],g=v[1];g.dateShow=(0,x["default"])(g.date).format("kk"),g.dateTime=(0,x["default"])(g.date).format("HH:mm"),g.index=h,n&&(0!==(0,x["default"])(g.date).distance(n.date)&&d(),i[h]=a.length),o.push(g),n=g}}catch(p){u=!0,f=p}finally{try{!r&&c["return"]&&c["return"]()}finally{if(u)throw f}}d(),e.data.daysIndex=i,e.data.days=a,console.log(e.data);var w=!0,y=!1,M=void 0;try{for(var D,P=(0,l["default"])(t.plan.entries());!(w=(D=P.next()).done);w=!0){var k=(0,s["default"])(D.value,2),h=k[0],g=k[1];h!=t.plan.length-1&&0!=h&&delete g.location}}catch(p){y=!0,M=p}finally{try{!w&&P["return"]&&P["return"]()}finally{if(y)throw M}}t.now=t.onway[t.onway.length-1]}},{key:"getData",value:function(){var t=this;o.A.get("data/data.json",function(a){if(1==a.status){t.data=a.content,t.dealData();var o=g["default"].compile(w["default"].detailInfo);e("#blog .container").append(o(t.data));var n=g["default"].compile(w["default"].timeLine);e("#timeline").append(n(t.data)),e("#timeline .time").tooltipster({position:"bottom",theme:"tooltipster-shadow"}),t.doms={mouse:e("#mouse-next"),container:e("#blog>.container"),timelines:e("#timeline .time"),timelinesDiv:e("#timeline")},t.page=e(".userInfo");var i=t.getScrollPostion();t.canMouse=!i.isPageDown,i.isPageDown?t.showMouse():t.hideMouse(),t.map=new v["default"]("mapContainer",t.data.way,{user_marker:!0,polyline_animated:!0,zoom:!0}),t.doms.timelines.filter("[index='0']").addClass("focused"),t.doms.timelines.on("click",function(){var a=e(this),o=parseInt(a.attr("index")),n=t.index>o?"down":"up";t.index=o,t.changePage(n)})}})}}]),t}(),P=function(){return new D};t["default"]=P}).call(t,a(1),a(18))},98:function(e,t){}});
//# sourceMappingURL=way.5d14dad21e49bd04e2a0.js.map